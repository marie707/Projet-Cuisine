$(document).ready(function(){function envoiRecette(){$.fancybox({autoDimensions:false,width:'800',height:'350',centerOnScroll:true,href:url_href_fancybox_envoiRecette});return false;}
function addToCarnet(){$.fancybox({autoDimensions:false,autoSize:false,width:'800',height:'auto',centerOnScroll:true,href:url_href_fancybox_addToCarnet});return false;}
function getCookie(name){var value="; "+document.cookie;var parts=value.split("; "+name+"=");if(parts.length==2)
return parts.pop().split(";").shift();}
if(zend_hasIdentity==false){var timeoutEnvoiRecette=null;var timeoutaddToCarnet=null;$('#imprimerRecette').click(function(){clearTimeout(timeoutEnvoiRecette);clearTimeout(timeoutaddToCarnet);});$('#sub_carnet_recette').click(function(){clearTimeout(timeoutEnvoiRecette);clearTimeout(timeoutaddToCarnet);});if(localStorage.getItem("sessionPHPID")==getCookie("PHPSESSID")&&localStorage.getItem("popupEnvoiRecetteChoix")!=null&&localStorage.getItem("popupEnvoiRecetteChoix")==1){timeoutaddToCarnet=setTimeout(function(){addToCarnet();localStorage.removeItem("popupEnvoiRecetteChoix");},30000);}}
if(ajoutrecettecarnet==true){ajoutCarnetRecette();}
if(popuploadphoto==true){popupUploadPhoto($('.popup_upload_photo').attr('href'));}
$('.carousel').carousel({interval:2000});if(pub_not_empty==true){$('.bannpub').click(function(){$.ajax({method:"get",url:"/"+CONFIG.lang+"/banniere/onclick/id/"+pub_id_recette,success:function(html){},error:function(html){}});});}
if($('input[name=detect_mobile]').val()==0){var bottom_right_img={has_scrolled:false,has_overflowed:false};$(window).scroll(function(){var scrollTop=$(this).scrollTop();var intro=$('#mainIntro').height();var crossSell=$('#cardContainer');if(scrollTop>400){crossSell.fadeIn();}else{crossSell.fadeOut();}});}
$('#votez').hide();if(valeur_cookie==false){$('#votez').hide();$('.ui-stars-star').mouseover(function(){$('#votez').show();$('.rating-L').hide();});$('.ui-stars-star').mouseout(function(){$('#votez').hide();$('.rating-L').show();});}
$('.nb_pers').change(function(){var id_recette=$(this).attr('id');var newrecipe=$(this).attr('newrecipe');if(newrecipe===undefined){newrecipe=0;}
$.ajax({method:"POST",url:"/"+CONFIG.lang+"/ingredient/recette",data:{id:id_recette,nb:$(this).val(),lien:1,newrecipe:newrecipe},beforeSend:function(){$('.ingredients').css({'opacity':'0.5'});},success:function(html){$('.ingredients').html(html);$('.ingredients').css({'opacity':'1'});changeNbPersPourListeCourse();}});});});function ajoutCarnetRecette(){var widthMobile='500';if($('input[name=detect_mobile]').val()==1){widthMobile='auto';}
$.fancybox({autoDimensions:false,width:widthMobile,height:'auto',scrolling:'no',centerOnScroll:true,href:CONFIG.url_base+'/'+CONFIG.lang+'/recette/addcarnet/id/'+id_recette});}
function changeNbPersPourListeCourse(){var nb_pers="";$('.nb_pers').each(function(){nb_pers+=$(this).val()+",";});$('input[name="nb_pers_recette"]').val(nb_pers.substr(0,(nb_pers.length-1)));}
function lienListeCourse(){var url=CONFIG.url_base+"/"+CONFIG.lang+"/listecourse/addrecettelistecourse";$.ajax({url:url,type:'POST',data:{recettes:$('input[name="ids_recette"]').val(),nb_pers:$('input[name="nb_pers_recette"]').val()},success:function(html){data=JSON.parse(html);jQuery.each(data,function(i,val){addalert(val.status,val.message,true);});upadatenbaniercourseinheader();},error:function(html){addalert("error","Un problÃ¨me est survenu",true);}});}
function lienImprimerRecette(id_recette){var ids_recette=$('input[name="ids_recette"]').val();var nb_pers_recette=$('input[name="nb_pers_recette"]').val();if(id_recette>0){ids_recette=id_recette;nb_pers_recette=$('select[name="nb_pers_'+id_recette+'"] option:selected').val();}
var url=CONFIG.url_base+"/"+CONFIG.lang+"/recette/imprimerrecette/id/"+ids_recette+"/nb_pers/"+nb_pers_recette;window.open(url);}
function popupImpressionRecette(form_post){if(form_post==1){var email=$('#email_imprimerrecette').val();var nl=0;if($('#nl_imprimerrecette').is(':checked'))
nl=1;$.ajax({method:'POST',url:CONFIG.url_base+'/'+CONFIG.lang+'/ajax/impressionrecette',data:{email:email,nl:nl},beforeSend:function(){$('#chargement_imprimerrecette').html('<img src="'+url_image+'loading_cours.gif" alt="Image chargement" width="50" heigth="50">');},success:function(html){$('#chargement_imprimerrecette').html('');if(html=="ok"){$.fancybox.close();lienImprimerRecette();}else{alert(html);}}});}else{$.fancybox({autoDimensions:false,width:'500',height:'auto',scrolling:'no',centerOnScroll:true,href:CONFIG.url_base+'/'+CONFIG.lang+'/recette/impressionrecette'});}}